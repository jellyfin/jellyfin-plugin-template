<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>FrameDropCheck</title>
    </head>
    <body>
        <div id="FrameDropCheckConfigPage" data-role="page" class="page type-interior pluginConfigurationPage" data-require="emby-input,emby-button,emby-select,emby-checkbox">
            <div data-role="content">
                <div class="content-primary">
                    <form id="FrameDropCheckConfigForm">
                        <div class="inputContainer">
                            <label class="inputLabel inputLabelUnfocused" for="FfmpegPath">FFmpeg 경로</label>
                            <input id="FfmpegPath" name="FfmpegPath" type="text" is="emby-input" />
                            <div class="fieldDescription">FFmpeg 실행 파일의 전체 경로를 입력하세요. (예: /usr/bin/ffmpeg 또는 ffmpeg.exe)</div>
                        </div>

                        <div class="inputContainer">
                            <label class="inputLabel inputLabelUnfocused" for="MediaScanTime">미디어 스캔 시간 (HH:mm)</label>
                            <input id="MediaScanTime" name="MediaScanTime" type="time" is="emby-input" />
                            <div class="fieldDescription">프레임 드롭 검사를 시작할 시간을 입력하세요. (예: 새벽 2시 → 02:00)</div>
                        </div>

                        <div class="inputContainer">
                            <label class="inputLabel inputLabelUnfocused" for="BackupPath">프레임 드롭 미디어 백업 경로</label>
                            <input id="BackupPath" name="BackupPath" type="text" is="emby-input" />
                            <div class="fieldDescription">프레임 드롭이 발견된 미디어 파일을 백업할 경로를 입력하세요. (예: /media/backup/framedrop)</div>
                        </div>
                        <div>
                            <button is="emby-button" type="submit" class="raised button-submit block emby-button">
                                <span>Save</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            <script type="text/javascript">
                var FrameDropCheckConfig = {
                    pluginUniqueId: "d3075c1e-6e7c-4a70-b989-170aa2f4aa3e",
                };

                document.querySelector("#FrameDropCheckConfigPage").addEventListener("pageshow", function () {
                    Dashboard.showLoadingMsg();
                    ApiClient.getPluginConfiguration(FrameDropCheckConfig.pluginUniqueId).then(function (config) {
                        document.querySelector("#FfmpegPath").value = config.FfmpegPath || "";
                        document.querySelector("#MediaScanTime").value = config.MediaScanTime || "";
                        document.querySelector("#BackupPath").value = config.BackupPath || "";

                        Dashboard.hideLoadingMsg();
                    });
                });

                document.querySelector("#FrameDropCheckConfigForm").addEventListener("submit", function (e) {
                    Dashboard.showLoadingMsg();
                    ApiClient.getPluginConfiguration(FrameDropCheckConfig.pluginUniqueId).then(function (config) {
                        config.FfmpegPath = document.querySelector("#FfmpegPath").value;
                        config.MediaScanTime = document.querySelector("#MediaScanTime").value;
                        config.BackupPath = document.querySelector("#BackupPath").value;
                        ApiClient.updatePluginConfiguration(FrameDropCheckConfig.pluginUniqueId, config).then(function (result) {
                            Dashboard.processPluginConfigurationUpdateResult(result);
                        });
                    });

                    e.preventDefault();
                    return false;
                });
            </script>
        </div>
    </body>
</html>
